{% extends "base.html" %}
{% load static %}

{% block title %}Dashboard - In√≠cio{% endblock %}

{% block content %}
<div class="p-4">
  <div class="container mt-3">
    <div class="row justify-content-center text-center g-3">

      <div class="col-12 col-md-4">
        <div id="card_hover_patri" class="bg-info bg-opacity-25 text-dark p-3 rounded h-100">
          <a id="linkPatrimonios" class="nav-link text-dark position-relative d-block" href="#" style="height: 100%; cursor:pointer;">
            <h4 class="card-title">Patrim√¥nios</h4>
            <div class="card-quantity" id="patrimonios-quantity">0</div>
            <div class="card-icon">üèõÔ∏è</div>
          </a>
        </div>
      </div>

      <div class="col-12 col-md-4">
        <div id="card_hover_uni" class="bg-success text-white p-3 rounded h-100">
          <a id="linkUnidades" class="nav-link text-dark position-relative d-block" href="#" style="height: 100%; cursor:pointer;">
            <h4 class="card-title">Unidades</h4>
            <div class="card-quantity" id="unidades-quantity">0</div>
            <div class="card-icon">üöì</div>
          </a>
        </div>
      </div>

      <div class="col-12 col-md-4">
        <div id="card_hover_pend" class="bg-warning p-3 rounded h-100">
          <a href="#" class="nav-link text-dark position-relative d-block" style="height: 100%; cursor:pointer;" id="abrirModalPendentes">
            <h4 class="card-title">Pendentes</h4>
            <div class="card-quantity" id="pendentes-quantity">0</div>
            <div class="card-icon">‚ö†Ô∏è</div>
          </a>
        </div>
      </div>

    </div>

    <div class="container mt-5 pizza-shadow" style="max-width: 400px;">
      <div class="card shadow-sm" style="background-color:  #87898b; border: none;">
        <div class="card-header pizza-header" style="background-color: #87898b; border-bottom: none;">
          <h5 class="card-title mb-0 text-light">Distribui√ß√£o de Patrim√¥nios</h5>
        </div>
        <div class="card-body text-light" style="background-color: #9da1a5;">
          <canvas class="txt_l" id="patrimonioPieChart" width="400" height="400" style="max-width: 100%; height: auto; cursor: pointer;"></canvas>
        </div>
      </div>
    </div>

    <!-- Modal Lista de Pendentes -->
    <div class="modal fade" id="modalPendentes" tabindex="-1" aria-labelledby="modalPendentesLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content text-dark">
          <div class="modal-header">
            <h5 class="modal-title" id="modalPendentesLabel">Patrim√¥nios Pendentes</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
          </div>
          <div class="modal-body">
            <table class="table table-hover" id="tabelaPendentes">
              <thead>
                <tr>
                  <th>Tipo</th>
                  <th>Modelo</th>
                  <th>C√≥digo Atual</th>
                  <th>Editar C√≥digo</th>
                  <th>A√ß√£o</th>
                </tr>
              </thead>
              <tbody>
              </tbody>
            </table>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div id="popupAviso" style="display:none; position: fixed; top: 50%; left: 50%; 
    transform: translate(-50%, -50%); background: #dc3545; color: white; padding: 20px 30px; 
    border-radius: 8px; box-shadow: 0 0 15px rgba(0,0,0,0.6); z-index: 1050; font-weight: 600; align-items: center; gap: 15px; display: none;">
    <span id="mensagemAviso">Voc√™ n√£o tem acesso a essa funcionalidade.</span>
    <button id="fecharAviso" style="background: white; border:none; padding: 3px 8px; border-radius: 4px; cursor: pointer; font-weight: 600; color: #dc3545;">X</button>
  </div>

  <div id="fundoAviso" style="display:none; position: fixed; top: 0; left: 0; width: 100vw; 
    height: 100vh; background: rgba(0,0,0,0.5); z-index: 1040;"></div>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="{% static 'js/index.js' %}"></script>

  <script>
    const urlPatrimonios = "{% url 'patrimonios' %}";
    const urlUnidade = "{% url 'unidade' %}";
    const urlRelatorios = "{% url 'relatorios' %}";
    const urlUsuarios = "{% url 'usuarios' %}";
  </script>
{% endblock %}
